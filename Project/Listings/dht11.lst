C51 COMPILER V9.60.7.0   DHT11                                                             04/24/2025 16:53:24 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE DHT11
OBJECT MODULE PLACED IN ..\Output\dht11.obj
COMPILER INVOKED BY: D:\APP\Keil_v5\C51\BIN\C51.EXE ..\BSP\Src\dht11.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(..\BSP\Inc;
                    -..\Core\Inc;..\Driver;..\Emembed\Inc;..\SYSTEM\Inc) DEBUG OBJECTEXTEND PRINT(.\Listings\dht11.lst) OBJECT(..\Output\dht1
                    -1.obj)

line level    source

   1          #include  "dht11.h" 
   2          
   3          void DHT11_start()
   4          {
   5   1          Temp_Hum = 1;
   6   1          delay_us(2);
   7   1      
   8   1          Temp_Hum = 0;
   9   1          delay_ms(25);   //Êãâ‰ΩéÂª∂Êó∂18ms‰ª•‰∏ä
  10   1      
  11   1          Temp_Hum = 1;
  12   1          delay_us(30);   //ÊãâÈ´ò Âª∂Êó∂ 20~40usÔºåÂèñ‰∏≠Èó¥ÂÄº 30us
  13   1      }
  14          
  15           /**************************************************************************************
  16           * Êèè  Ëø∞ : ‰ªéDHT11ËØªÂèñ‰∏Ä‰∏™Â≠óËäÇÔºåMSBÂÖàË°å
  17           * ÂÖ•  ÂèÇ : Êó†
  18           * ËøîÂõûÂÄº : uint8_t
  19           **************************************************************************************/
  20          static uint8_t Read_Byte(void)  
  21          {       
  22   1              uint8_t i, dat = 0;
  23   1      
  24   1              for( i = 0; i < 8; i++ )    
  25   1              {          
  26   2                      while(!Temp_Hum); //ÊØèbit‰ª•50us‰ΩéÁîµÂπ≥Ê†áÁΩÆÂºÄÂßãÔºåËΩÆËØ¢Áõ¥Âà∞‰ªéÊú∫ÂèëÂá∫ ÁöÑ50us ‰ΩéÁîµÂπ≥ ÁªìÊ
             -ùü
  27   2      
  28   2                      delay_us(40); //Âª∂Êó∂Á∫¶40us,Ëøô‰∏™Âª∂Êó∂ÈúÄË¶ÅÂ§ß‰∫éÊï∞ÊçÆ0ÊåÅÁª≠ÁöÑÊó∂Èó¥Âç≥ÂèØ                
  29   2      
  30   2              if(Temp_Hum)   //Á∫¶40usÂêé‰ªç‰∏∫È´òÁîµÂπ≥Ë°®Á§∫Êï∞ÊçÆ‚Äú1‚Äù
  31   2                      {
  32   3                              while(Temp_Hum);  //Á≠âÂæÖÊï∞ÊçÆ1ÁöÑÈ´òÁîµÂπ≥ÁªìÊùü
  33   3                              dat|=(uint8_t)(0x01<<(7-i));  //ÊääÁ¨¨7-i‰ΩçÁΩÆ1ÔºåMSBÂÖàË°å 
  34   3                      }
  35   2                      else     //40usÂêé‰∏∫‰ΩéÁîµÂπ≥Ë°®Á§∫Êï∞ÊçÆ‚Äú0‚Äù
  36   2                      {                          
  37   3                              dat&=(uint8_t)~(0x01<<(7-i)); //ÊääÁ¨¨7-i‰ΩçÁΩÆ0ÔºåMSBÂÖàË°å
  38   3                      }
  39   2              }
  40   1              return dat;     
  41   1      }
  42          
  43           /**************************************************************************************
  44           * Êèè  Ëø∞ : ‰∏ÄÊ¨°ÂÆåÊï¥ÁöÑÊï∞ÊçÆ‰º†Ëæì‰∏∫40bitÔºåÈ´ò‰ΩçÂÖàÂá∫
  45           * ÂÖ•  ÂèÇ : 8bit ÊπøÂ∫¶Êï¥Êï∞ + 8bit ÊπøÂ∫¶Â∞èÊï∞ + 8bit Ê∏©Â∫¶Êï¥Êï∞ + 8bit Ê∏©Â∫¶Â∞èÊï∞ + 8bit Ê†°È™åÂ
             -íå 
  46           * ËøîÂõûÂÄº : Êó†
  47           **************************************************************************************/
  48          void Read_DHT11(void)   //Ê∏©Êπø‰º†ÊÑüÂêØÂä®
  49          {
  50   1          uint8_t R_H,R_L,T_H,T_L,revise; 
  51   1      
C51 COMPILER V9.60.7.0   DHT11                                                             04/24/2025 16:53:24 PAGE 2   

  52   1          DHT11_start();
  53   1              
  54   1          if(!Temp_Hum)      //Âà§Êñ≠‰ªéÊú∫ÊòØÂê¶Êúâ‰ΩéÁîµÂπ≥ÂìçÂ∫î‰ø°Âè∑ Â¶Ç‰∏çÂìçÂ∫îÂàôË∑≥Âá∫ÔºåÂìçÂ∫îÂàôÂêë‰∏
             -ãËøêË°å   
  55   1          {
  56   2              while(!Temp_Hum);   //ËΩÆËØ¢Áõ¥Âà∞‰ªéÊú∫ÂèëÂá∫ÁöÑ83us ‰ΩéÁîµÂπ≥ ÂìçÂ∫î‰ø°Âè∑ÁªìÊùü
  57   2              while(Temp_Hum);    //ËΩÆËØ¢Áõ¥Âà∞‰ªéÊú∫ÂèëÂá∫ÁöÑ87us È´òÁîµÂπ≥ Ê†áÁΩÆ‰ø°Âè∑ÁªìÊùü
  58   2                              
  59   2                                /*ÂºÄÂßãÊé•Êî∂Êï∞ÊçÆ*/ 
  60   2              R_H= Read_Byte();
  61   2              R_L= Read_Byte();
  62   2              T_H= Read_Byte();
  63   2              T_L= Read_Byte();
  64   2      
  65   2              revise = Read_Byte();
  66   2      
  67   2              Temp_Hum =1 ;                   //ËØªÂèñÁªìÊùüÔºå‰∏ªÊú∫ÊãâÈ´ò
  68   2      
  69   2              if((R_H+R_L+T_H+T_L)==revise)      //ÊúÄÂêé‰∏ÄÂ≠óËäÇ‰∏∫Ê†°È™å‰ΩçÔºåÊ†°È™åÊòØÂê¶Ê≠£Á°Æ
  70   2              {
  71   3                  temp.dht11_temp  = T_H;
  72   3                  temp.dht11_humidity = R_H;
  73   3              }
  74   2                  // temp.dht11_temp     = ((TH<<8) | TL);
  75   2                  // temp.dht11_humidity = ((RH<<8) | RL);
  76   2              //     temp.dht11_humidity = RH;
  77   2              //     temp.dht11_temp = RL;
  78   2              //     printf("The value of tmep_value is %d \r\n",(int)temp.dht11_temp);
  79   2              //     printf("The value of humidity_value is %d \r\n",(int)temp.dht11_humidity);
  80   2              // } 
  81   2              // else
  82   2              // {
  83   2              //     temp.dht11_temp  = 0x19;
  84   2              //     temp.dht11_humidity = 0x41;
  85   2              // }
  86   2          }
  87   1              
  88   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    229    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----       6
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
